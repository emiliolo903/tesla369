<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tesla Pro + Hist√≥rico Poseada</title>
<style>
body {margin:0;font-family:Arial,sans-serif;background:#111;color:#fff;display:flex;justify-content:center;padding:20px;}
.container{width:100%;max-width:500px;text-align:center;}
h1{color:#00F5E0;font-size:28px;margin-bottom:20px;}
h2{color:#FFD700;font-size:22px;margin-bottom:10px;}
input, textarea{width:80%;padding:12px;font-size:18px;border-radius:8px;border:none;margin-bottom:15px;}
textarea{height:120px;}
button{width:85%;padding:14px;font-size:18px;background:#00F5E0;color:#111;border:none;border-radius:10px;cursor:pointer;margin-bottom:20px;}
.resultado{background:#222;padding:15px;border-radius:12px;margin-bottom:15px;text-align:left;font-size:18px;}
.resultado span{color:#00FFAA;font-weight:bold;}
.fuerte{color:#FFD700;}
.poseada{margin-top:30px;}
.nota{font-size:14px;color:#aaa;margin-top:10px;}
.historial{margin-top:20px;padding:15px;background:#222;border-radius:12px;}
.historial textarea{width:90%;}
</style>
</head>
<body>
<div class="container">
<h1>‚ö° Tesla Pro + Hist√≥rico Poseada</h1>

<h2>Quiniela Tradicional (M√©todo Tesla)</h2>
<input type="text" id="inputTradicional" placeholder="Ingres√° un n√∫mero de 4 cifras">
<button onclick="generarTradicional()">Generar Tradicional</button>
<div id="resultadosTradicional"></div>

<div class="poseada">
<h2>Quiniela Poseada Correntina</h2>
<input type="text" id="inputPoseada" placeholder="Ingres√° los 10 n√∫meros del sorteo anterior (00-99), separados por coma o espacio">
<button onclick="generarPoseada()">Generar 2 jugadas Tesla</button>
<div class="nota">Poseada Correntina usando m√©todo Tesla puro. Solo 5 N√∫meros Principal y 5 Respaldo.</div>
<div id="resultadosPoseada"></div>
</div>

<div class="historial">
<h2>Hist√≥rico Poseada (√∫ltimas 20 jugadas)</h2>
<textarea id="inputHistorico" placeholder="Ingres√° las 20 jugadas anteriores, cada jugada con 10 n√∫meros separados por coma, y cada jugada en nueva l√≠nea"></textarea>
<button onclick="guardarHistorico()">Guardar Hist√≥rico</button>
<div class="nota">Estos n√∫meros se usar√°n autom√°ticamente para calcular Principal y Respaldo. Se mantiene hist√≥rico persistente y se actualiza con cada nuevo sorteo.</div>
</div>

<script>
// Tabla Tesla
const tablaTesla = {0:['0','0'],1:['0','0'],2:['5','7'],3:['8','0'],4:['6','9'],5:['2','7'],6:['4','9'],7:['5','2'],8:['3','0'],9:['3','4']};
const agencias = ["Corrientes","Ciudad","Bonaerense","Santa Fe","C√≥rdoba","Entre R√≠os","Chaco"];

// Cargar hist√≥rico desde localStorage si existe
let historicoPoseada = JSON.parse(localStorage.getItem('historicoPoseada')) || [];

// Funci√≥n para calcular energ√≠a de cada n√∫mero seg√∫n Tesla
function energiaNumero(num){
  let suma=num.split('').reduce((acc,d)=>acc+parseInt(d),0);
  if(suma % 3 ===0) return "‚òÄÔ∏è Ma√±ana";
  if(suma % 3 ===1) return "üåÜ Tarde";
  return "üåô Noche";
}

// Funci√≥n para asignar agencia por n√∫mero
function agenciaPorNumero(num){
  const n=parseInt(num[0]);
  return agencias[n % agencias.length];
}

// Funci√≥n para sugerencia cuaterno/terno/ambos
function sugerenciaJugada(cuaterno, terno, ambos){
  let uniqueC = new Set(cuaterno.split('')).size;
  let uniqueT = new Set(terno.split('')).size;
  let uniqueA = new Set(ambos.split('')).size;
  if(uniqueC===4) return "üéØ Cuaterno";
  if(uniqueT===3) return "‚úÖ Terno";
  return "‚ö° Ambos";
}

// Tradicional
function generarTradicional(){
  const nro=document.getElementById('inputTradicional').value;
  if(nro.length!==4 || isNaN(nro)){alert('Ingres√° un n√∫mero v√°lido de 4 cifras');return;}
  let jugadas=[];
  for(let i=0;i<2;i++){
    let cuaterno='',terno='';
    for(let j=0;j<4;j++){
      let nums=tablaTesla[parseInt(nro[j])];
      cuaterno+=nums[i%2];
      if(j>0)terno+=nums[i%2];
    }
    let ambos = cuaterno.slice(2,4);
    let energiaC = energiaNumero(cuaterno);
    let energiaT = energiaNumero(terno);
    let energiaA = energiaNumero(ambos);
    let agenciaC = agenciaPorNumero(cuaterno);
    let agenciaT = agenciaPorNumero(terno);
    let agenciaA = agenciaPorNumero(ambos);
    let sugerencia = sugerenciaJugada(cuaterno, terno, ambos);
    jugadas.push({cuaterno,terno,ambos,energiaC,energiaT,energiaA,agenciaC,agenciaT,agenciaA,sugerencia});
  }
  let html='';
  jugadas.forEach((j,idx)=>{
    html+=`<div class="resultado"><strong>Jugada ${idx+1}</strong><br>
      Cuaterno: <span>${j.cuaterno}</span> (${j.energiaC}) - Agencia: <span>${j.agenciaC}</span><br>
      Terno: <span>${j.terno}</span> (${j.energiaT}) - Agencia: <span>${j.agenciaT}</span><br>
      Ambos: <span>${j.ambos}</span> (${j.energiaA}) - Agencia: <span>${j.agenciaA}</span><br>
      Sugerencia: <span>${j.sugerencia}</span>
    </div>`;
  });
  document.getElementById('resultadosTradicional').innerHTML=html;
}

// Poseada Correntina
function generarPoseada(){
  let inputRaw=document.getElementById('inputPoseada').value;
  let input=inputRaw.split(/[\s,]+/).map(v=>v.trim()).filter(v=>v!=='').map(v=>v.padStart(2,'0'));
  if(input.length!==10){alert('Ingres√° 10 n√∫meros del sorteo anterior'); return;}

  // Guardar la nueva jugada en hist√≥rico
  historicoPoseada.push(input);
  if(historicoPoseada.length>20) historicoPoseada.shift(); // Mantener solo 20 √∫ltimas jugadas
  localStorage.setItem('historicoPoseada', JSON.stringify(historicoPoseada));

  let principal=[], respaldo=[];
  if(historicoPoseada.length>0){
    // Calcular frecuencia de n√∫meros en Principal y Respaldo de las √∫ltimas 20 jugadas
    let frecuencias={};
    historicoPoseada.forEach(jugada=>{
      jugada.forEach(n=>{
        frecuencias[n]=(frecuencias[n]||0)+1;
      });
    });
    // Ordenar por frecuencia descendente
    let numerosOrdenados = Object.keys(frecuencias).sort((a,b)=>frecuencias[b]-frecuencias[a]);
    principal = numerosOrdenados.slice(0,5);
    respaldo = numerosOrdenados.slice(5,10);
  } else {
    // M√©todo Tesla puro
    let transformados = input.map(n=>{
      let d1=parseInt(n[0]), d2=parseInt(n[1]);
      return tablaTesla[d1][0]+tablaTesla[d2][0];
    });
    principal=transformados.slice(0,5);
    respaldo=transformados.slice(5,10);
  }

  let html=`<div class="resultado"><strong>Principal</strong>: <span>${principal.join(' - ')}</span></div>`;
  html+=`<div class="resultado"><strong>Respaldo</strong>: <span>${respaldo.join(' - ')}</span></div>`;
  document.getElementById('resultadosPoseada').innerHTML=html;
}

// Guardar hist√≥rico manualmente (por si quieres cargar 20 jugadas de golpe)
function guardarHistorico(){
  let input=document.getElementById('inputHistorico').value.split(/\n+/).map(line=>line.trim()).filter(line=>line!=='');
  if(input.length!==20){alert('Ingres√° exactamente 20 jugadas completas'); return;}
  let jugadas = [];
  for(let line of input){
    let nums=line.split(/[\s,]+/).map(n=>n.trim().padStart(2,'0'));
    if(nums.length!==10){alert('Cada jugada debe tener exactamente 10 n√∫meros'); return;}
    jugadas.push(nums);
  }
  historicoPoseada = jugadas;
  localStorage.setItem('historicoPoseada', JSON.stringify(historicoPoseada));
  alert('Hist√≥rico de 20 jugadas guardado correctamente. Ahora se usar√° autom√°ticamente para Principal y Respaldo.');
}
</script>
</body>
</html>
