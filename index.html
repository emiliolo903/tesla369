<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tesla Pro + Hist√≥rico Poseada</title>

<style>
body {margin:0;font-family:Arial;background:#111;color:#fff;display:flex;justify-content:center;padding:20px;}
.container{width:100%;max-width:500px;text-align:center;}
h1{color:#00F5E0;font-size:26px;margin-bottom:20px;}
h2{color:#FFD700;font-size:20px;margin-bottom:10px;}
input, textarea{width:90%;padding:12px;font-size:18px;border-radius:8px;border:none;margin-bottom:15px;}
textarea{height:140px;}
button{width:95%;padding:14px;font-size:18px;background:#00F5E0;color:#111;border:none;border-radius:10px;cursor:pointer;margin-bottom:15px;}
.resultado{background:#222;padding:15px;border-radius:12px;margin-bottom:15px;text-align:left;font-size:16px;}
.resultado span{color:#00FFAA;font-weight:bold;}
.nota{font-size:13px;color:#aaa;margin-top:10px;}
.poseada{margin-top:30px;}
.historial{margin-top:20px;padding:15px;background:#222;border-radius:12px;}
</style>
</head>

<body>
<div class="container">

<h1>‚ö° Tesla Pro + Hist√≥rico Poseada</h1>

<h2>Quiniela Tradicional</h2>
<input type="text" id="inputTradicional" placeholder="Ingres√° un n√∫mero de 4 cifras">
<button onclick="generarTradicional()">Generar Tradicional</button>
<div id="resultadosTradicional"></div>

<div class="poseada">
<h2>Quiniela Poseada Correntina</h2>
<input type="text" id="inputPoseada" placeholder="Ingres√° los 10 n√∫meros del sorteo anterior">
<button onclick="generarPoseada()">Generar Poseada</button>
<div id="resultadosPoseada"></div>
</div>

<div class="historial">
<h2>Hist√≥rico (20 jugadas)</h2>
<textarea id="inputHistorico" placeholder="Peg√° 20 jugadas anteriores, una por l√≠nea (10 n√∫meros cada una)"></textarea>
<button onclick="guardarHistorico()">Guardar Hist√≥rico</button>
<div class="nota">Se guarda permanente y se vuelve a mostrar aunque recargues.</div>
</div>

</div>

<script>

// ===== CONFIGURACI√ìN =====

const tablaTesla = {
0:['0','0'],1:['0','0'],2:['5','7'],3:['8','0'],4:['6','9'],
5:['2','7'],6:['4','9'],7:['5','2'],8:['3','0'],9:['3','4']
};

const agencias = ["Corrientes","Ciudad","Bonaerense","Santa Fe","C√≥rdoba","Entre R√≠os","Chaco"];

let historicoPoseada = JSON.parse(localStorage.getItem('historicoPoseada')) || [];

// ===== AL CARGAR LA APP =====
window.onload = function(){
  if(historicoPoseada.length > 0){
    document.getElementById("inputHistorico").value =
      historicoPoseada.map(j => j.join(" ")).join("\n");
  }
};

// ===== FUNCIONES GENERALES =====

function energiaNumero(num){
  let suma = num.split('').reduce((a,b)=>a+parseInt(b),0);
  if(suma%3===0) return "‚òÄÔ∏è Ma√±ana";
  if(suma%3===1) return "üåÜ Tarde";
  return "üåô Noche";
}

function agenciaPorNumero(num){
  const n=parseInt(num[0]);
  return agencias[n % agencias.length];
}

function sugerencia(c,t,a){
  if(new Set(c).size===4) return "üéØ Cuaterno";
  if(new Set(t).size===3) return "‚úÖ Terno";
  return "‚ö° Ambos";
}

// ===== TRADICIONAL =====

function generarTradicional(){
  const nro=document.getElementById('inputTradicional').value;
  if(nro.length!==4 || isNaN(nro)){alert("N√∫mero inv√°lido");return;}

  let html='';

  for(let i=0;i<2;i++){
    let c='',t='';
    for(let j=0;j<4;j++){
      c+=tablaTesla[nro[j]][i];
      if(j>0) t+=tablaTesla[nro[j]][i];
    }
    let a=c.slice(2,4);

    html+=`
    <div class="resultado">
    <strong>Jugada ${i+1}</strong><br>
    Cuaterno: <span>${c}</span> (${energiaNumero(c)}) - ${agenciaPorNumero(c)}<br>
    Terno: <span>${t}</span> (${energiaNumero(t)}) - ${agenciaPorNumero(t)}<br>
    Ambos: <span>${a}</span> (${energiaNumero(a)}) - ${agenciaPorNumero(a)}<br>
    Sugerencia: <span>${sugerencia(c,t,a)}</span>
    </div>`;
  }

  document.getElementById("resultadosTradicional").innerHTML=html;
}

// ===== POSEADA MIXTA =====

function generarPoseada(){
  let input=document.getElementById('inputPoseada').value
  .split(/[\s,]+/).map(v=>v.padStart(2,'0'));

  if(input.length!==10){alert("Ingres√° 10 n√∫meros");return;}

  historicoPoseada.push(input);
  if(historicoPoseada.length>20) historicoPoseada.shift();

  localStorage.setItem('historicoPoseada',JSON.stringify(historicoPoseada));

  let frecuencia={};

  historicoPoseada.forEach((jugada,index)=>{
    let peso=index+1; // ponderaci√≥n por recencia
    jugada.forEach(n=>{
      frecuencia[n]=(frecuencia[n]||0)+peso;
    });
  });

  let ordenados=Object.keys(frecuencia)
  .sort((a,b)=>frecuencia[b]-frecuencia[a]);

  let principal=ordenados.slice(0,5);
  let respaldo=ordenados.slice(5,10);

  document.getElementById("resultadosPoseada").innerHTML=`
  <div class="resultado"><strong>Principal:</strong> ${principal.join(" - ")}</div>
  <div class="resultado"><strong>Respaldo:</strong> ${respaldo.join(" - ")}</div>`;

  // volver a mostrar hist√≥rico en textarea
  document.getElementById("inputHistorico").value =
    historicoPoseada.map(j => j.join(" ")).join("\n");
}

// ===== GUARDAR HIST√ìRICO MANUAL =====

function guardarHistorico(){
  let lineas=document.getElementById('inputHistorico').value
  .split(/\n+/).map(l=>l.trim()).filter(l=>l!=='');

  if(lineas.length!==20){alert("Deben ser exactamente 20 jugadas");return;}

  historicoPoseada=[];

  for(let l of lineas){
    let nums=l.split(/[\s,]+/).map(n=>n.padStart(2,'0'));
    if(nums.length!==10){alert("Cada jugada debe tener 10 n√∫meros");return;}
    historicoPoseada.push(nums);
  }

  localStorage.setItem('historicoPoseada',JSON.stringify(historicoPoseada));
  alert("Hist√≥rico guardado correctamente");
}

</script>

</body>
</html>
