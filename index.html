<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Tesla 369</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #38bdf8;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      font-size: 16px;
    }
    button {
      background: #38bdf8;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    .box {
      background: #020617;
      padding: 10px;
      margin-top: 15px;
      border-radius: 8px;
    }
    .item {
      margin: 4px 0;
    }
  </style>
</head>
<body>

<h1>Tesla 369</h1>

<input type="text" id="numeroBase" placeholder="Ingresar NRO base">
<button onclick="ejecutarTesla()">Generar</button>

<div class="box">
  <h3>Cifras Tesla</h3>
  <div id="cifras"></div>
</div>

<div class="box">
  <h3>Ambos (Top 2)</h3>
  <div id="ambos"></div>
</div>

<div class="box">
  <h3>Ternos (Top 2)</h3>
  <div id="ternos"></div>
</div>

<div class="box">
  <h3>Cuaternos (Top 2)</h3>
  <div id="cuaternos"></div>
</div>

<div class="box">
  <h3>Historial</h3>
  <div id="historial"></div>
</div>

<script>
/* TABLA TESLA */
const tablaTesla = {
  0: [0,0],
  1: [0,0],
  2: [5,7],
  3: [8,0],
  4: [6,9],
  5: [2,7],
  6: [4,9],
  7: [5,2],
  8: [3,0],
  9: [3,4]
};

let historial = [];

function ejecutarTesla() {
  const base = document.getElementById("numeroBase").value.trim();
  if (base === "") return;

  let conteo = {};

  for (let d of base) {
    if (tablaTesla[d]) {
      tablaTesla[d].forEach(n => {
        conteo[n] = (conteo[n] || 0) + 1;
      });
    }
  }

  // CIFRAS TESLA
  const cifras = Object.entries(conteo)
    .sort((a, b) => b[1] - a[1])
    .slice(0, 4)
    .map(e => e[0]);

  mostrar("cifras", cifras);

  // RANKING POR PESO
  const ambosRank = rankingPorPeso(combinaciones(cifras, 2), conteo);
  const ternosRank = rankingPorPeso(combinaciones(cifras, 3), conteo);
  const cuaternosRank = rankingPorPeso(combinaciones(cifras, 4), conteo);

  mostrar("ambos", ambosRank.slice(0, 2));
  mostrar("ternos", ternosRank.slice(0, 2));
  mostrar("cuaternos", cuaternosRank.slice(0, 2));

  historial.unshift(base);
  mostrar("historial", historial.slice(0, 10));
}

function combinaciones(arr, n) {
  if (n === 1) return arr.map(x => [x]);
  let res = [];
  for (let i = 0; i <= arr.length - n; i++) {
    const rest = combinaciones(arr.slice(i + 1), n - 1);
    rest.forEach(r => res.push([arr[i], ...r]));
  }
  return res.map(c => c.join(""));
}

function rankingPorPeso(combos, conteo) {
  return combos
    .map(c => {
      let peso = 0;
      for (let d of c) {
        peso += conteo[d] || 0;
      }
      return { jugada: c, peso };
    })
    .sort((a, b) => b.peso - a.peso)
    .map(x => x.jugada);
}

function mostrar(id, datos) {
  document.getElementById(id).innerHTML =
    datos.map(d => `<div class="item">${d}</div>`).join("");
}
</script>

</body>
 </html>
